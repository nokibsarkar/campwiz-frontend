try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="844fecb7-ac5f-42f1-8d8a-1c7d85db864c",e._sentryDebugIdIdentifier="sentry-dbid-844fecb7-ac5f-42f1-8d8a-1c7d85db864c")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2442],{34222:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(95155),s=n(66766),a=n(13719),r=n(6874),l=n.n(r);let o=()=>(0,i.jsx)(l(),{href:"/",className:"cursor-pointer",children:(0,i.jsx)(s.default,{src:a.A,alt:"Logo of CampWiz",height:80,style:{margin:"auto"}})})},36963:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var i=n(95155),s=n(34222),a=n(55857),r=n(6874),l=n.n(r),o=n(1384),u=n(29414);let d=e=>{let{skipCount:t}=e;return(0,i.jsxs)(a.default,{variant:"outlined",color:"secondary",sx:{m:1},endIcon:(0,i.jsx)(o.A,{}),onClick:()=>window.location.reload(),children:["Show skipped ",t," submissions"]})},c=e=>{let{campaignId:t,roundId:n,skipCount:r}=e;return(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center h-full w-full",children:[(0,i.jsx)(s.A,{}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold",children:"All Set"}),(0,i.jsx)("p",{className:"text-lg",children:"Seems like, You have no pending submissions to evaluate in this round."}),(0,i.jsxs)("div",{className:"flex-row flex justify-center",children:[(0,i.jsx)(l(),{href:"/campaign/".concat(t),children:(0,i.jsx)(a.default,{variant:"contained",color:"primary",sx:{m:1},startIcon:(0,i.jsx)(u.A,{}),children:"Go to Round"})}),(0,i.jsx)(l(),{href:"/round/".concat(n,"/submission/evaluated"),children:(0,i.jsx)(a.default,{variant:"outlined",color:"secondary",sx:{m:1},endIcon:(0,i.jsx)(o.A,{}),children:"Modify your votes"})}),r>0&&(0,i.jsx)(d,{skipCount:r,roundId:n,campaignId:t})]})]})]})}},60106:(e,t,n)=>{Promise.resolve().then(n.bind(n,71527)),Promise.resolve().then(n.bind(n,72292)),Promise.resolve().then(n.bind(n,7433))},69220:(e,t,n)=>{"use strict";n.d(t,{_:()=>s});var i=n(34477);let s=(0,i.createServerReference)("6070dc5bab919eb75a74cd481130eea0e7254e4903",i.callServer,void 0,i.findSourceMapURL,"fetchAPIFromBackendListWithErrorHandling")},71527:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var i=n(95155),s=n(91553),a=n(12115),r=n(52018),l=n(66655),o=n(36963),u=n(12296);let d=async e=>{try{let t=await fetch(e);if(!t.ok)throw Error(t.statusText);let n=await t.blob();return{url:URL.createObjectURL(n)}}catch(e){return{error:e.message}}},c=e=>{var t;let{roundId:n,initailEvaluations:c,next:m,limit:h=1,campaignId:g,isPublicJury:p,assignmentCount:f,evaluationCount:b}=e,[x,v]=a.useState(c),[y,S]=a.useState(m),[j,w]=a.useState(0),[I,A]=a.useState(!1),[E,C]=(0,a.useState)(null!=(t=null==x?void 0:x[0])?t:null),[k,N]=(0,a.useState)(!0),[D,_]=(0,a.useState)(null),[L,P]=(0,a.useState)((null==x?void 0:x.length)>j),R=L?x[j+1]:null,[z,T]=(0,a.useState)(f),[q,U]=(0,a.useState)(b),[W,F]=(0,a.useState)(!1),[M,O]=(0,a.useState)(!1),[G,H]=(0,a.useState)(null),[B,J]=(0,a.useState)(0);(0,a.useEffect)(()=>{if(!x)return C(null);if(M)return;let e=x[j];if(e&&e.submission&&!e.submission.description&&!M){console.log("Fetching Description");let t=new URLSearchParams({action:"query",format:"json",prop:"imageinfo",titles:"File:".concat(e.submission.title),formatversion:"2",iiprop:"extmetadata|url",iiurlwidth:"640",iiurlheight:"640",iimetadataversion:"latest",iiextmetadatafilter:"ImageDescription",origin:"*"}).toString();O(!0),fetch("https://commons.wikimedia.org/w/api.php?"+t).then(e=>e.json()).then(e=>{if(e.query&&e.query.pages&&e.query.pages.length>0){let t=e.query.pages[0];if(t.imageinfo&&t.imageinfo.length>0){let e=t.imageinfo[0];if(e.extmetadata&&e.extmetadata.ImageDescription){let t=document.createElement("div");t.innerHTML=e.extmetadata.ImageDescription.value;let n=t.innerText;t.remove(),console.log("Fetched Description:",n),H(n),C(e=>e&&e.submission?{...e,submission:{...e.submission,description:n}}:null)}}}}).catch(e=>{console.error("Error fetching description:",e)}).finally(()=>{O(!1)})}C(e)},[x,j]),console.log("Current Evaluation",E),(0,a.useEffect)(()=>{R&&R.submission&&R.submission.thumburl&&R.submission.mediatype===l.z.IMAGE&&R.submission.thumburl.startsWith("http")&&d(R.submission.thumburl).then(e=>{!e.error&&e.url&&v(t=>t.map((t,n)=>t.submission&&n===j+1?{...t,submission:{...t.submission,thumburl:e.url,submissionId:t.submission.submissionId||""}}:t))})},[j,R]);let Y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;console.log("Next Image Wrapper",j,null==x?void 0:x.length),N(!1),w(t=>t+e)},K=async e=>{try{if(W||!E||!E.submission||!k)return;F(!0);let t=await (0,r.A)(n,p,[{evaluationId:E.evaluationId,score:e,comment:null,submissionId:E.submission.submissionId,description:G}]);if(!t)throw Error("Something went wrong");if("detail"in t)throw Error(t.detail);T(t.totalAssignmentCount),U(t.totalEvaluatedCount),console.log("Submitted"),Y(),_(null)}catch(e){_(e.message)}finally{F(!1)}};if((0,a.useEffect)(()=>{y&&n&&h&&L&&x&&x.length&&(j<x.length-1||(A(!0),(0,s.A)({roundId:n,limit:h,next:y,includeSubmissions:!0,isPublic:p,includeEvaluated:!1,includeNonEvaluated:!0,randomize:!0}).then(async e=>{if(!e)return;if("detail"in e)return void _(e.detail);let t=e.data;T(e.totalAssignmentCount),U(e.totalEvaluatedCount),v(e=>[...e,...t]),S(e.next),P(void 0!==e.next&&e.next!==y&&""!==e.next),A(!1)})))},[j,x,x.length,L,p,h,y,n]),!E)return(0,i.jsx)(o.A,{roundId:n,campaignId:g,skipCount:B});let{submission:Q}=E;return Q?(0,i.jsx)(u.A,{campaignId:g,submission:Q,currentEvaluation:E,nextImageWrapper:Y,imageLoaded:k,setImageLoaded:N,evaluationCount:q,assignmentCount:z,isPublicJury:p,isLoading:I,currentCursor:j,setCurrentCursor:w,submit:K,saving:W,error:D,returnTo:"/campaign/".concat(g),hasNext:!0,onSkip:()=>{J(e=>e+1)}}):null}},72292:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>I});var i=n(95155),s=n(12115),a=n(16779),r=n(51877),l=n(55965),o=n(55857),u=n(29716),d=n(12422),c=n(78679),m=n(19463);n(85572);var h=n(66332),g=n(66766),p=n(91553),f=n(52018),b=n(36963),x=n(50412),v=n(79608),y=n(59869);let S={button:{position:"absolute",bottom:0,right:0}},j=()=>document.body.style.overflow="hidden",w=()=>document.body.style.overflow="auto",I=e=>{let{initailEvaluations:t,limit:n,roundId:I,isPublicJury:A,campaignId:E,next:C}=e,[k,N]=(0,s.useState)(t),[D,_]=(0,s.useState)(C),[L,P]=(0,s.useState)(!1),[R,z]=(0,s.useState)(null),[T,q]=(0,s.useState)(null),U=async()=>{P(!0);try{let e=100/n,t=k.map((t,n)=>({evaluationId:t.evaluationId,score:e*(k.length-n),comment:null,submissionId:t.submissionId})),i=await (0,f.A)(I,A,t);if(!i)return;if("detail"in i)console.error(i.detail);else{let e=await (0,p.A)({roundId:I,limit:n,next:D,includeSubmissions:!0,isPublic:A});if(!e)return;if("detail"in e)return void z(e.detail);let t=e.data;void 0===e.next||e.next===D||""===e.next?(_(void 0),N([])):(N(t),_(e.next))}}finally{P(!1)}};return R?(0,i.jsxs)("p",{children:["Error : ",R]}):0===k.length?(0,i.jsx)(b.A,{campaignId:E,roundId:I,skipCount:0}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.default,{}),(0,i.jsxs)("div",{children:[(0,i.jsx)(a.Ay,{allowDrag:!L,onSortEnd:(e,t)=>{console.log(e,t),N(n=>(0,m.p)(n,e,t))},style:{display:"flex",flexWrap:"wrap",userSelect:"none"},draggedItemClassName:"k",children:k.map((e,t)=>{let{submission:n}=e;return n&&(0,i.jsx)(a.Uq,{children:(0,i.jsx)(r.A,{overlap:"circular",anchorOrigin:{vertical:"top",horizontal:"left"},badgeContent:t+1,color:"primary",children:(0,i.jsxs)("div",{style:{position:"relative",margin:"2em",cursor:"grab",userSelect:"none",borderRadius:"20%"},className:"w-20 h-20 sm:w-24 sm:h-24",onDragStart:j,onDragEnd:w,children:[(0,i.jsx)(l.A,{color:"primary",size:"small",sx:S.button,"aria-label":"show-preview",onClick:()=>q(n),children:(0,i.jsx)(h.A,{})}),(0,i.jsx)(g.default,{src:n.thumburl,alt:n.title,style:{pointerEvents:"none",borderRadius:"20%"},fill:!0,unoptimized:!0,slot:"img"})]})})},n.submissionId)})}),(0,i.jsx)("div",{style:{textAlign:"center",marginTop:20},children:(0,i.jsx)(o.default,{variant:"contained",color:"primary",onClick:U,loading:L,disabled:L,startIcon:(0,i.jsx)(y.A,{}),sx:{mr:0,ml:"auto",right:0},children:"Submit"})}),T&&(0,i.jsxs)(u.A,{open:!!T,onClose:()=>q(null),sx:{textAlign:"center"},children:[(0,i.jsx)(d.A,{children:(0,i.jsx)(g.default,{src:T.thumburl,alt:T.title,width:T.thumbwidth||640,height:T.thumbheight,unoptimized:!0})}),(0,i.jsx)(c.A,{children:(0,i.jsx)(o.default,{onClick:()=>q(null),color:"error",variant:"contained",startIcon:(0,i.jsx)(v.A,{}),children:"Close"})})]})]})]})}},85572:()=>{},91553:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(69220);let s=async e=>{let{roundId:t,includeSkipped:n,limit:s,next:a,prev:r,includeSubmissions:l,isPublic:o,includeEvaluated:u,includeNonEvaluated:d,randomize:c}=e,m=new URLSearchParams({roundId:t});n&&m.append("includeSkipped",n.toString()),s&&m.append("limit",s.toString()),a&&m.append("next",a),r&&m.append("prev",r),l&&m.append("includeSubmission",l.toString()),o&&m.append("isPublic",o.toString()),void 0!==u&&m.append("includeEvaluated",u.toString()),void 0!==d&&m.append("includeNonEvaluated",d.toString()),void 0!==c&&m.append("randomize",String(c)),console.log("loadNextEvaluation",m.toString());let h=(o?"/round/".concat(t,"/next/public"):"/evaluation/")+"?".concat(m.toString()),g=await (0,i._)(h);return g?("detail"in g,g):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[9245,6454,6766,9978,225,7638,6318,9566,9559,6813,4554,8609,4850,8441,3595,7358],()=>t(60106)),_N_E=e.O()}]);