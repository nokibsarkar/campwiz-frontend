try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="5b72cdb9-26a6-4689-912f-b0a3ccdd78df",e._sentryDebugIdIdentifier="sentry-dbid-5b72cdb9-26a6-4689-912f-b0a3ccdd78df")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2442],{31776:(e,t,i)=>{"use strict";i.d(t,{_:()=>s});var n=i(34477);let s=(0,n.createServerReference)("607a53450b95d0576bb90d170cbfce2666314ab6e8",n.callServer,void 0,n.findSourceMapURL,"fetchAPIFromBackendListWithErrorHandling")},34222:(e,t,i)=>{"use strict";i.d(t,{A:()=>l});var n=i(95155),s=i(66766),r=i(13719),a=i(6874),o=i.n(a);let l=()=>(0,n.jsx)(o(),{href:"/",className:"cursor-pointer",children:(0,n.jsx)(s.default,{src:r.A,alt:"Logo of CampWiz",height:80,style:{margin:"auto"}})})},36963:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var n=i(95155),s=i(34222),r=i(55857),a=i(6874),o=i.n(a),l=i(1384),u=i(29414);let d=e=>{let{skipCount:t}=e;return(0,n.jsxs)(r.default,{variant:"outlined",color:"secondary",sx:{m:1},endIcon:(0,n.jsx)(l.A,{}),onClick:()=>window.location.reload(),children:["Show skipped ",t," submissions"]})},c=e=>{let{campaignId:t,roundId:i,skipCount:a}=e;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-full w-full",children:[(0,n.jsx)(s.A,{}),(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"All Set"}),(0,n.jsx)("p",{className:"text-lg",children:"Seems like, You have no pending submissions to evaluate in this round."}),(0,n.jsxs)("div",{className:"flex-row flex justify-center",children:[(0,n.jsx)(o(),{href:"/campaign/".concat(t),children:(0,n.jsx)(r.default,{variant:"contained",color:"primary",sx:{m:1},startIcon:(0,n.jsx)(u.A,{}),children:"Go to Round"})}),(0,n.jsx)(o(),{href:"/round/".concat(i,"/submission/evaluated"),children:(0,n.jsx)(r.default,{variant:"outlined",color:"secondary",sx:{m:1},endIcon:(0,n.jsx)(l.A,{}),children:"Modify your votes"})}),a>0&&(0,n.jsx)(d,{skipCount:a,roundId:i,campaignId:t})]})]})]})}},60106:(e,t,i)=>{Promise.resolve().then(i.bind(i,71527)),Promise.resolve().then(i.bind(i,72292)),Promise.resolve().then(i.bind(i,7433))},71527:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var n=i(95155),s=i(91553),r=i(12115),a=i(52018),o=i(66655),l=i(36963),u=i(12296);let d=async e=>{try{let t=await fetch(e);if(!t.ok)throw Error(t.statusText);let i=await t.blob();return{url:URL.createObjectURL(i)}}catch(e){return{error:e.message}}},c=e=>{var t;let{roundId:i,initailEvaluations:c,next:m,limit:h=1,campaignId:p,isPublicJury:b,assignmentCount:g,evaluationCount:f}=e,[x,v]=r.useState(c),[y,S]=r.useState(m),[j,I]=r.useState(0),[w,A]=r.useState(!1),[E,C]=(0,r.useState)(null!=(t=null==x?void 0:x[0])?t:null),[k,N]=(0,r.useState)(!0),[D,_]=(0,r.useState)(null),[L,P]=(0,r.useState)((null==x?void 0:x.length)>j),z=L?x[j+1]:null,[R,T]=(0,r.useState)(g),[W,q]=(0,r.useState)(f),[U,F]=(0,r.useState)(!1),[M,O]=(0,r.useState)(!1),[G,H]=(0,r.useState)(null),[B,J]=(0,r.useState)(0);(0,r.useEffect)(()=>{if(!x)return C(null);if(M)return;let e=x[j];if(e&&e.submission&&!e.submission.description&&!M){console.log("Fetching Description");let t=new URLSearchParams({action:"query",format:"json",prop:"imageinfo",titles:"File:".concat(e.submission.title),formatversion:"2",iiprop:"extmetadata|url",iiurlwidth:"640",iiurlheight:"640",iimetadataversion:"latest",iiextmetadatafilter:"ImageDescription",origin:"*"}).toString();O(!0),fetch("https://commons.wikimedia.org/w/api.php?"+t).then(e=>e.json()).then(e=>{if(e.query&&e.query.pages&&e.query.pages.length>0){let t=e.query.pages[0];if(t.imageinfo&&t.imageinfo.length>0){let e=t.imageinfo[0];if(e.extmetadata&&e.extmetadata.ImageDescription){let t=document.createElement("div");t.innerHTML=e.extmetadata.ImageDescription.value;let i=t.innerText;t.remove(),console.log("Fetched Description:",i),H(i),C(t=>t&&t.submission?{...t,submission:{...t.submission,description:e.extmetadata.ImageDescription.value}}:null)}}}}).catch(e=>{console.error("Error fetching description:",e)}).finally(()=>{O(!1)})}C(e)},[x,j]),(0,r.useEffect)(()=>{z&&z.submission&&z.submission.url&&z.submission.mediatype===o.z.IMAGE&&z.submission.url.startsWith("http")&&d(z.submission.url).then(e=>{!e.error&&e.url&&v(t=>t.map((t,i)=>t.submission&&i===j+1?{...t,submission:{...t.submission,url:e.url,submissionId:t.submission.submissionId||""}}:t))})},[j,z]);let Y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;console.log("Next Image Wrapper",j,null==x?void 0:x.length),N(!1),I(t=>t+e)},K=async e=>{try{if(U||!E||!E.submission||!k)return;F(!0);let t=await (0,a.A)(i,b,[{evaluationId:E.evaluationId,score:e,comment:null,submissionId:E.submission.submissionId,description:G}]);if(!t)throw Error("Something went wrong");if("detail"in t)throw Error(t.detail);T(t.totalAssignmentCount),q(t.totalEvaluatedCount),console.log("Submitted"),Y(),_(null)}catch(e){_(e.message)}finally{F(!1)}};if((0,r.useEffect)(()=>{y&&i&&h&&L&&x&&x.length&&(j<x.length-1||(A(!0),(0,s.A)({roundId:i,limit:h,next:y,includeSubmissions:!0,isPublic:b,includeEvaluated:!1,includeNonEvaluated:!0,randomize:!0}).then(async e=>{if(!e)return;if("detail"in e)return void _(e.detail);let t=e.data;T(e.totalAssignmentCount),q(e.totalEvaluatedCount),v(e=>[...e,...t]),S(e.next),P(void 0!==e.next&&e.next!==y&&""!==e.next),A(!1)})))},[j,x,x.length,L,b,h,y,i]),(0,r.useEffect)(()=>{z&&z.submission&&z.submission.url&&z.submission.mediatype===o.z.IMAGE&&z.submission.url.startsWith("http")&&d(z.submission.url).then(e=>{!e.error&&e.url&&v(t=>t.map((t,i)=>t.submission&&i===j+1?{...t,submission:{...t.submission,url:e.url,submissionId:t.submission.submissionId||""}}:t))})},[j,z]),!E)return(0,n.jsx)(l.A,{roundId:i,campaignId:p,skipCount:B});let{submission:Q}=E;return Q?(0,n.jsx)(u.A,{campaignId:p,submission:Q,currentEvaluation:E,nextImageWrapper:Y,imageLoaded:k,setImageLoaded:N,evaluationCount:W,assignmentCount:R,isPublicJury:b,isLoading:w,currentCursor:j,setCurrentCursor:I,submit:K,saving:U,error:D,returnTo:"/campaign/".concat(p),hasNext:!0,onSkip:()=>{J(e=>e+1)}}):null}},72292:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>w});var n=i(95155),s=i(12115),r=i(16779),a=i(51877),o=i(55965),l=i(55857),u=i(29716),d=i(12422),c=i(78679),m=i(19463);i(85572);var h=i(66332),p=i(66766),b=i(91553),g=i(52018),f=i(36963),x=i(50412),v=i(79608),y=i(59869);let S={button:{position:"absolute",bottom:0,right:0}},j=()=>document.body.style.overflow="hidden",I=()=>document.body.style.overflow="auto",w=e=>{let{initailEvaluations:t,limit:i,roundId:w,isPublicJury:A,campaignId:E,next:C}=e,[k,N]=(0,s.useState)(t),[D,_]=(0,s.useState)(C),[L,P]=(0,s.useState)(!1),[z,R]=(0,s.useState)(null),[T,W]=(0,s.useState)(null),q=async()=>{P(!0);try{let e=100/i,t=k.map((t,i)=>({evaluationId:t.evaluationId,score:e*(k.length-i),comment:null,submissionId:t.submissionId})),n=await (0,g.A)(w,A,t);if(!n)return;if("detail"in n)console.error(n.detail);else{let e=await (0,b.A)({roundId:w,limit:i,next:D,includeSubmissions:!0,isPublic:A});if(!e)return;if("detail"in e)return void R(e.detail);let t=e.data;void 0===e.next||e.next===D||""===e.next?(_(void 0),N([])):(N(t),_(e.next))}}finally{P(!1)}};return z?(0,n.jsxs)("p",{children:["Error : ",z]}):0===k.length?(0,n.jsx)(f.A,{campaignId:E,roundId:w,skipCount:0}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.default,{}),(0,n.jsxs)("div",{children:[(0,n.jsx)(r.Ay,{allowDrag:!L,onSortEnd:(e,t)=>{console.log(e,t),N(i=>(0,m.p)(i,e,t))},style:{display:"flex",flexWrap:"wrap",userSelect:"none"},draggedItemClassName:"k",children:k.map((e,t)=>{let{submission:i}=e;return i&&(0,n.jsx)(r.Uq,{children:(0,n.jsx)(a.A,{overlap:"circular",anchorOrigin:{vertical:"top",horizontal:"left"},badgeContent:t+1,color:"primary",children:(0,n.jsxs)("div",{style:{position:"relative",margin:"2em",cursor:"grab",userSelect:"none",borderRadius:"20%"},className:"w-20 h-20 sm:w-24 sm:h-24",onDragStart:j,onDragEnd:I,children:[(0,n.jsx)(o.A,{color:"primary",size:"small",sx:S.button,"aria-label":"show-preview",onClick:()=>W(i),children:(0,n.jsx)(h.A,{})}),(0,n.jsx)(p.default,{src:i.thumburl,alt:i.title,style:{pointerEvents:"none",borderRadius:"20%"},fill:!0,unoptimized:!0,slot:"img"})]})})},i.submissionId)})}),(0,n.jsx)("div",{style:{textAlign:"center",marginTop:20},children:(0,n.jsx)(l.default,{variant:"contained",color:"primary",onClick:q,loading:L,disabled:L,startIcon:(0,n.jsx)(y.A,{}),sx:{mr:0,ml:"auto",right:0},children:"Submit"})}),T&&(0,n.jsxs)(u.A,{open:!!T,onClose:()=>W(null),sx:{textAlign:"center"},children:[(0,n.jsx)(d.A,{children:(0,n.jsx)(p.default,{src:T.thumburl,alt:T.title,width:T.thumbwidth||640,height:T.thumbheight,unoptimized:!0})}),(0,n.jsx)(c.A,{children:(0,n.jsx)(l.default,{onClick:()=>W(null),color:"error",variant:"contained",startIcon:(0,n.jsx)(v.A,{}),children:"Close"})})]})]})]})}},85572:()=>{},91553:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var n=i(31776);let s=async e=>{let{roundId:t,includeSkipped:i,limit:s,next:r,prev:a,includeSubmissions:o,isPublic:l,includeEvaluated:u,includeNonEvaluated:d,randomize:c}=e,m=new URLSearchParams({roundId:t});i&&m.append("includeSkipped",i.toString()),s&&m.append("limit",s.toString()),r&&m.append("next",r),a&&m.append("prev",a),o&&m.append("includeSubmission",o.toString()),l&&m.append("isPublic",l.toString()),void 0!==u&&m.append("includeEvaluated",u.toString()),void 0!==d&&m.append("includeNonEvaluated",d.toString()),void 0!==c&&m.append("randomize",String(c)),console.log("loadNextEvaluation",m.toString());let h=(l?"/round/".concat(t,"/next/public"):"/evaluation/")+"?".concat(m.toString()),p=await (0,n._)(h);return p?("detail"in p,p):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[9245,6454,6766,9978,225,7638,6318,9566,9559,6813,4554,8609,4850,8441,3595,7358],()=>t(60106)),_N_E=e.O()}]);